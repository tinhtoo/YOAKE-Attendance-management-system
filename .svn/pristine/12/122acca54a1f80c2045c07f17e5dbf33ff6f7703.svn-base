<!-- 社員情報照会 -->

@extends('menu.main')

@section('title', '社員情報照会')

@section('content')
<div id="contents-stage">
    <table class="BaseContainerStyle1">
        <tbody>
            <tr>
                <td>
                    <div id="UpdatePanel1">
                        <form method="GET" action="{{ route('search') }}">
                            {{ csrf_field() }}
                            <table class="InputFieldStyle1">
                                <tbody>
                                    <tr>
                                        <th>社員番号</th>
                                        <td>
                                            <input name="filter[txtEmpCd]" style="width: 80px;"
                                                id="txtEmpCd"
                                                type="search" maxlength="10" class="imeDisabled"
                                                oninput="value = onlyHalfWord(value)"
                                                value="{{ old('txtEmpCd', !empty($search_data['txtEmpCd']) ? $search_data['txtEmpCd'] : '') }}">
                                            @if ($errors->has('txtEmpCd'))
                                            <span class="alert-danger">{{ $errors->first('txtEmpCd') }}</span>
                                            @endif
                                        </td>
                                    </tr>
                                    </tr>
                                    <tr>
                                        <th>社員カナ名</th>
                                        <td>
                                            <input name="filter[txtEmpKana]" style="width: 160px;" 
                                            class="imeOn" id="txtEmpKana" type="search" maxlength="20"
                                            value="{{ old('txtEmpKana', !empty($search_data['txtEmpKana']) ? $search_data['txtEmpKana'] : '') }}">
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>部門</th>
                                        <td>
                                            <input name="filter[txtDeptCd]" 
                                                class="imeDisabled" 
                                                id="txtDeptCd" 
                                                style="width: 50px;" 
                                                type="text" 
                                                maxlength="6"
                                                style="ime-inactive;"
                                                value="{{ old('filter[txtDeptCd]', !empty($search_data['txtDeptCd']) ? $search_data['txtDeptCd']:'') }}"
                                                oninput="value = onlyHalfWord(value)"
                                            >
                                            <input name="btnSearchDeptCd" class="SearchButton" id="btnSearchDeptCd" type="button" value="?" onclick="SearchDept();return false">
                                            <input 
                                                name="deptName" 
                                                class="OutlineLabel" 
                                                type="text" 
                                                style="width: 200px; height: 23px; display: inline-block;" 
                                                id="deptName" 
                                                value="{{ old('deptName', !empty($request_data['deptName']) ? $request_data['deptName']:'') }}"
                                                readonly="readonly"
                                            >
                                            @if ($errors->has('filter.txtDeptCd'))
                                            <span class="text-danger d-block">{{ $errors->first('filter.txtDeptCd')  }}</span>
                                            @endif
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div>
                                <p class="FunctionMenu1">
                                    <a class="left" id="hlAddEmp" href="{{ url('/master/MT10EmpEditor') }}">新規社員登録</a>
                                    <input class="SearchButton" type="submit" value="検索">
                                    <input class="SearchButton" name="CancelButton" type="submit" value="キャンセル" onClick="Cancel()">
                                </p>
                            </div>
                            <div class="clearBoth"></div>
                            <div class="line"></div>
                            <ul class="HolizonListMenu1" style="text-align: left">
                                <li><input type="submit" name="button_ALL" value="全件"></li>
                                <li><input type="submit" name="button_A" value="あ"></li>
                                <li><input type="submit" name="button_KA" value="か"></li>
                                <li><input type="submit" name="button_SA" value="さ"></li>
                                <li><input type="submit" name="button_TA" value="た"></li>
                                <li><input type="submit" name="button_NA" value="な"></li>
                                <li><input type="submit" name="button_HA" value="は"></li>
                                <li><input type="submit" name="button_MA" value="ま"></li>
                                <li><input type="submit" name="button_YA" value="や"></li>
                                <li><input type="submit" name="button_RA" value="ら"></li>
                                <li><input type="submit" name="button_WA" value="わ"></li>
                                <li><input type="submit" name="button_EN" value="英字"></li>
                            </ul>
                            <div class="line"></div>
                            <div class="GridViewStyle1">
                                <table style="border-collapse: separate;">
                                    <tbody>
                                        <tr>
                                            <th>
                                                社員
                                            </th>
                                            <th>
                                                社員
                                            </th>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="GridViewStyle1">
                                <div class="two-col">
                                    <table tabindex="7" class="GridViewSpace" id="gvEmp"
                                        style="border-collapse: collapse;" border="1" rules="all" cellspacing="0">
                                        <tbody>
                                            @if (count($search_results) < 1)
                                                <tr style="width:70px; text-align:center;">
                                                    <td><span>{{ $messages }}</span></td>
                                                </tr>
                                            @elseif (!empty($search_results))
                                            @foreach ($search_results as $item)
                                                <tr>
                                                    <td class="col-sm-4">
                                                        <a href="{{ url('master/MT10EmpEditor/'. $item->EMP_CD )}}">
                                                            {{ $item->EMP_CD }} :{{ $item->EMP_NAME }}</a>
                                                    </td>
                                                </tr>
                                            @endforeach
                                            @endif
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="line"></div>
                            <div class="d-flex justify-content-center">
                                {{ $search_results->links()}}
                            </div>
                            <div class="line"></div>
                            <div class="mb-2 mt-4 text-center">
                                <p class="ButtonField1">
                                    <input class="CancelButton" name="CancelButton" type="submit" value="キャンセル" onClick="Cancel()">
                                </p>
                            </div>
                        </form>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
@endsection

@section('script')
<script>
    //キャンセルボタン
    function Cancel(){
        $("#txtEmpCd, #txtEmpKana, #txtDeptCd, #deptName").val('');
    }
    
    $(function() {
        // 入力可能文字：半角英数
        onlyHalfWord = n => n.replace(/[０-９Ａ-Ｚａ-ｚ]/g, s => String.fromCharCode(s.charCodeAt(0) - 65248))
                            .replace(/[^0-9a-zA-Z]/g, '');
    });
</script>
@endsection
