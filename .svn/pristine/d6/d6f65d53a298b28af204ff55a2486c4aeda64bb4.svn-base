<?php

namespace App\Repositories\Master;

use Illuminate\Http\Request;
use App\Http\Requests\MT02CalendarPtnRequest;
use App\Models\MT02CalendarPtn;
use App\Models\MT99Msg;
use App\Models\MT05Workptn;

class MT02CalendarPtnRepository
{
    public function CalendarPtns()
    {
        /**
         * カレンダーパターン情報取得
         * MT02CalendarPtnReference(カレンダーパターン情報入力「参照画面」)
         * @return $items (MT23CompanyReferenceController)
         */
        $calendarPtn = MT02CalendarPtn::where('CALENDAR_CLS_CD', '<>', '02')->paginate(30);
        // dd($calendarPtn);
        return $calendarPtn;
    }

    // /**
    //  * メッセージダイアログの取得
    //  * MT02CalendarPtnEditor(カレンダーパターン情報入力「ダイアログメッセージ」)
    //  * @return void
    //  */
    // public function Msg_1005()
    // {
    //     $msg_1005 = MT99Msg::where('MSG_NO', '1005')->pluck('MSG_CONT')->first();
    //     return $msg_1005;
    // }

    // /**
    //  * メッセージダイアログの取得
    //  * MT02CalendarPtnEditor(カレンダーパターン情報入力「ダイアログメッセージ」)
    //  * @return void
    //  */
    // public function Msg_1004()
    // {
    //     $msg_1004 = MT99Msg::where('MSG_NO', '1004')->pluck('MSG_CONT')->first();
    //     return $msg_1004;
    // }

    /**
     * 勤怠体系情報の取得
     * MT02CalendarPtnEditor(カレンダーパターン情報入力「勤怠体系ドロップダウン」)
     * @return void
     */
    public function WorkPtn()
    {
        $workptn = MT05Workptn::where('COM_CLS_CD', '01')->get();
        // $workptn = MT05Workptn::where('COM_CLS_CD', '01')->first();
        return $workptn;
    }

    // /**
    //  * 新規カレンダーパターン登録
    //  * MT02CalendarPtnEditor(カレンダーパターン情報入力「新規カレンダーパターン登録」)
    //  * @return void
    //  */
    // public function NewCalPtn(Request $request)
    // {
    //     $newPtnStore = MT02CalendarPtn::findorfail($request->CalendarCd);
    //     if($newPtnStore){
    //         return $newPtnStore;
    //     }
    // }
    
    // /**
    //  * 勤怠体系情報取得
    //  * MT02CalendarPtnEditor(カレンダーパターン情報入力「更新・修正用」)
    //  * @param [type] $id
    //  * @return void
    //  */
    // public function WorkPtnCls($id)
    // {
    //     $getworkptnCls = MT05Workptn::where('WORKPTN_CD', $id)->where('COM_CLS_CD', '01')->first();
    //     return $getworkptnCls;
    // }

    /**
     * カレンダーパターン情報取得
     * MT02CalendarPtnEditor(カレンダーパターン情報入力「更新・修正用」)
     * @return void
     */
    public function CalendarPtnsEdit($id)
    {
        // $calendarPtnEdit = MT02CalendarPtn::join('MT05_WORKPTN', 'MT05_WORKPTN.WORKPTN_CD', '=', 'MT02_CALENDAR_PTN.CALENDAR_CD')
        // ->where('MT02_CALENDAR_PTN.CALENDAR_CD', $id)
        // ->where('CALENDAR_CLS_CD', '<>', '02')
        // // ->pluck('CALENDAR_CD');
        // // ->get();
        // ->first();
        $calendarPtnEdit = MT02CalendarPtn::where('CALENDAR_CLS_CD', '<>', '02')->where('MT02_CALENDAR_PTN.CALENDAR_CD', $id)->first();
        return $calendarPtnEdit;
    }

}
